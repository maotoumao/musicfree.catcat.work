<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>插件机制简介 | MusicFree</title>
    <meta name="description" content="MusicFree —— 一个插件化、定制化、无广告的音乐播放器。">
    <link rel="preload stylesheet" href="/static/style.3afd5b87.css" as="style">
    
    <script type="module" src="/static/app.625df6fd.js"></script>
    <link rel="preload" href="/static/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/static/chunks/framework.ab515e0e.js">
    <link rel="modulepreload" href="/static/chunks/theme.5e50e894.js">
    <link rel="modulepreload" href="/static/plugin_introduction.md.f4570448.lean.js">
    <script>var _hmt=_hmt||[];(function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?69fd99ff9e858d9f8a0aacb145a2d542";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})();</script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5a346dfe><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5a346dfe data-v-ae24b3ad><div class="VPNavBar has-sidebar" data-v-ae24b3ad data-v-a0fd61f4><div class="container" data-v-a0fd61f4><div class="title" data-v-a0fd61f4><div class="VPNavBarTitle has-sidebar" data-v-a0fd61f4 data-v-86d1bed8><a class="title" href="/" data-v-86d1bed8><!--[--><!--]--><!--[--><img class="VPImage logo" src="/img/logo.png" alt data-v-8426fc1a><!--]--><!--[-->MusicFree<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-a0fd61f4><div class="curtain" data-v-a0fd61f4></div><div class="content-body" data-v-a0fd61f4><!--[--><!--]--><div class="VPNavBarSearch search" data-v-a0fd61f4><!--[--><!----><div id="docsearch"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg class="DocSearch-Search-Icon" width="20" height="20" viewBox="0 0 20 20" aria-label="search icon"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-a0fd61f4 data-v-7f418b0f><span id="main-nav-aria-label" class="visually-hidden" data-v-7f418b0f>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/usage/mobile/install.html" tabindex="0" data-v-7f418b0f data-v-42ef59de><!--[--><span data-v-42ef59de>使用指南</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/plugin/introduction.html" tabindex="0" data-v-7f418b0f data-v-42ef59de><!--[--><span data-v-42ef59de>插件开发</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/qa/common.html" tabindex="0" data-v-7f418b0f data-v-42ef59de><!--[--><span data-v-42ef59de>常见问题</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-9c007e85><span class="text" data-v-9c007e85><!----><span data-v-9c007e85>更新日志</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://github.com/maotoumao/MusicFree/blob/master/changelog.md" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->安卓版<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://github.com/maotoumao/MusicFreeDesktop/blob/master/changelog.md" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->桌面版<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-9c007e85><span class="text" data-v-9c007e85><!----><span data-v-9c007e85>😈我要进群</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/img/wechat_channel.jpg" data-v-43f1e123><!--[-->微信公众号<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://pd.qq.com/s/e7od7dpgu" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->QQ频道<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://musicfree.gitee.io" target="_blank" rel="noreferrer" tabindex="0" data-v-7f418b0f data-v-42ef59de><!--[--><span data-v-42ef59de>💫国内镜像</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-a0fd61f4 data-v-e6aabb21><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-e6aabb21 data-v-ce54a7d1 data-v-b1685198><span class="check" data-v-b1685198><span class="icon" data-v-b1685198><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-ce54a7d1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-ce54a7d1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-a0fd61f4 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/maotoumao" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-f80f8133><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><a class="VPSocialLink no-icon" href="https://space.bilibili.com/12866223" aria-label target="_blank" rel="noopener" data-v-7bc22406 data-v-f80f8133><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Bilibili</title><path d="M17.813 4.653h.854c1.51.054 2.769.578 3.773 1.574 1.004.995 1.524 2.249 1.56 3.76v7.36c-.036 1.51-.556 2.769-1.56 3.773s-2.262 1.524-3.773 1.56H5.333c-1.51-.036-2.769-.556-3.773-1.56S.036 18.858 0 17.347v-7.36c.036-1.511.556-2.765 1.56-3.76 1.004-.996 2.262-1.52 3.773-1.574h.774l-1.174-1.12a1.234 1.234 0 0 1-.373-.906c0-.356.124-.658.373-.907l.027-.027c.267-.249.573-.373.92-.373.347 0 .653.124.92.373L9.653 4.44c.071.071.134.142.187.213h4.267a.836.836 0 0 1 .16-.213l2.853-2.747c.267-.249.573-.373.92-.373.347 0 .662.151.929.4.267.249.391.551.391.907 0 .355-.124.657-.373.906zM5.333 7.24c-.746.018-1.373.276-1.88.773-.506.498-.769 1.13-.786 1.894v7.52c.017.764.28 1.395.786 1.893.507.498 1.134.756 1.88.773h13.334c.746-.017 1.373-.275 1.88-.773.506-.498.769-1.129.786-1.893v-7.52c-.017-.765-.28-1.396-.786-1.894-.507-.497-1.134-.755-1.88-.773zM8 11.107c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c0-.373.129-.689.386-.947.258-.257.574-.386.947-.386zm8 0c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c.017-.391.15-.711.4-.96.249-.249.56-.373.933-.373Z"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-a0fd61f4 data-v-40855f84 data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-9c007e85><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-9c007e85><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><!----><!--[--><!--[--><!----><div class="group" data-v-40855f84><div class="item appearance" data-v-40855f84><p class="label" data-v-40855f84>Appearance</p><div class="appearance-action" data-v-40855f84><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-40855f84 data-v-ce54a7d1 data-v-b1685198><span class="check" data-v-b1685198><span class="icon" data-v-b1685198><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-ce54a7d1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-ce54a7d1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-40855f84><div class="item social-links" data-v-40855f84><div class="VPSocialLinks social-links-list" data-v-40855f84 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/maotoumao" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-f80f8133><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><a class="VPSocialLink no-icon" href="https://space.bilibili.com/12866223" aria-label target="_blank" rel="noopener" data-v-7bc22406 data-v-f80f8133><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Bilibili</title><path d="M17.813 4.653h.854c1.51.054 2.769.578 3.773 1.574 1.004.995 1.524 2.249 1.56 3.76v7.36c-.036 1.51-.556 2.769-1.56 3.773s-2.262 1.524-3.773 1.56H5.333c-1.51-.036-2.769-.556-3.773-1.56S.036 18.858 0 17.347v-7.36c.036-1.511.556-2.765 1.56-3.76 1.004-.996 2.262-1.52 3.773-1.574h.774l-1.174-1.12a1.234 1.234 0 0 1-.373-.906c0-.356.124-.658.373-.907l.027-.027c.267-.249.573-.373.92-.373.347 0 .653.124.92.373L9.653 4.44c.071.071.134.142.187.213h4.267a.836.836 0 0 1 .16-.213l2.853-2.747c.267-.249.573-.373.92-.373.347 0 .662.151.929.4.267.249.391.551.391.907 0 .355-.124.657-.373.906zM5.333 7.24c-.746.018-1.373.276-1.88.773-.506.498-.769 1.13-.786 1.894v7.52c.017.764.28 1.395.786 1.893.507.498 1.134.756 1.88.773h13.334c.746-.017 1.373-.275 1.88-.773.506-.498.769-1.129.786-1.893v-7.52c-.017-.765-.28-1.396-.786-1.894-.507-.497-1.134-.755-1.88-.773zM8 11.107c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c0-.373.129-.689.386-.947.258-.257.574-.386.947-.386zm8 0c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c.017-.391.15-.711.4-.96.249-.249.56-.373.933-.373Z"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-a0fd61f4 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav reached-top" data-v-5a346dfe data-v-79c8c1df><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-79c8c1df><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-79c8c1df><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-79c8c1df>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-79c8c1df data-v-1c15a60a><button data-v-1c15a60a>返回顶部</button><!----></div></div><aside class="VPSidebar" data-v-5a346dfe data-v-b00e2fdd><div class="curtain" data-v-b00e2fdd></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-b00e2fdd><span class="visually-hidden" id="sidebar-aria-label" data-v-b00e2fdd> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-b00e2fdd><section class="VPSidebarItem level-0 has-active" data-v-b00e2fdd data-v-e31bd47b><!----><div class="items" data-v-e31bd47b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/plugin/introduction.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>插件机制简介</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/plugin/basic-type.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>基本媒体类型</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/plugin/protocol.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>插件协议</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/plugin/how-to-develop.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>举个栗子</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/plugin/internal-pkgs.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>内置的 npm 包</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/plugin/caution.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>注意事项</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5a346dfe data-v-669faec9><div class="VPDoc has-sidebar has-aside" data-v-669faec9 data-v-6b87e69f><!--[--><!--]--><div class="container" data-v-6b87e69f><div class="aside" data-v-6b87e69f><div class="aside-curtain" data-v-6b87e69f></div><div class="aside-container" data-v-6b87e69f><div class="aside-content" data-v-6b87e69f><div class="VPDocAside" data-v-6b87e69f data-v-3f215769><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-3f215769 data-v-d330b1bb><div class="content" data-v-d330b1bb><div class="outline-marker" data-v-d330b1bb></div><div class="outline-title" role="heading" aria-level="2" data-v-d330b1bb>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-d330b1bb><span class="visually-hidden" id="doc-outline-aria-label" data-v-d330b1bb> Table of Contents for current page </span><ul class="root" data-v-d330b1bb data-v-d0ee3533><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-6b87e69f><div class="content-container" data-v-6b87e69f><!--[--><!--]--><!----><main class="main" data-v-6b87e69f><div style="position:relative;" class="vp-doc _plugin_introduction" data-v-6b87e69f><div data-v-e3b08faf><h1 id="插件机制简介" tabindex="-1" data-v-e3b08faf>插件机制简介 <a class="header-anchor" href="#插件机制简介" aria-label="Permalink to &quot;插件机制简介&quot;" data-v-e3b08faf>​</a></h1><h2 id="概述" tabindex="-1" data-v-e3b08faf>概述 <a class="header-anchor" href="#概述" aria-label="Permalink to &quot;概述&quot;" data-v-e3b08faf>​</a></h2><p data-v-e3b08faf>插件机制是本软件的核心。当未安装插件时，本软件可以看作是一个 <strong data-v-e3b08faf>本地的音乐播放器</strong>；当安装插件之后，你便可以为这个播放器 <strong data-v-e3b08faf>扩展你自定义的音源</strong>。本文档便是开发插件的详细教程。</p><p data-v-e3b08faf>软件中的任何和音乐有关的 <strong data-v-e3b08faf> 底层功能 </strong>，包括但不限于播放、搜索、查看专辑信息、查看歌词、导入歌单等，都是基于 <strong data-v-e3b08faf>插件</strong> 实现的。</p><div class="tip custom-block" data-v-e3b08faf><p class="custom-block-title" data-v-e3b08faf>💡</p><p data-v-e3b08faf>因此，如果某个音源存在问题（比如无法播放、没有导入歌单等功能），那大概率是插件有问题。</p></div><p data-v-e3b08faf><strong data-v-e3b08faf>软件会决定在什么时候去调用插件中的某个方法，以及如何处理方法返回的数据</strong>；插件负责根据入参获取或处理特定格式的数据。软件中播放本地音乐功能实际上也是通过加载一个特殊的内置插件实现。</p><div class="img-container" data-v-e3b08faf><img src="/img/plugin-framework.png" data-v-e3b08faf></div><h2 id="前置知识" tabindex="-1" data-v-e3b08faf>前置知识 <a class="header-anchor" href="#前置知识" aria-label="Permalink to &quot;前置知识&quot;" data-v-e3b08faf>​</a></h2><p data-v-e3b08faf>开发插件前，你需要了解以下知识：</p><ul data-v-e3b08faf><li data-v-e3b08faf>javascript / typescript (ES7 语法)</li><li data-v-e3b08faf>js 模块化规范 (common.js)</li><li data-v-e3b08faf>包管理工具 npm，以及如何使用 npm 包</li><li data-v-e3b08faf>构建工具（webpack、parcel，可选）</li><li data-v-e3b08faf>JSBridge（可选）</li></ul><h2 id="原理" tabindex="-1" data-v-e3b08faf>原理 <a class="header-anchor" href="#原理" aria-label="Permalink to &quot;原理&quot;" data-v-e3b08faf>​</a></h2><h4 id="插件的本质" tabindex="-1" data-v-e3b08faf>插件的本质 <a class="header-anchor" href="#插件的本质" aria-label="Permalink to &quot;插件的本质&quot;" data-v-e3b08faf>​</a></h4><p data-v-e3b08faf>插件本质上是一个 <strong data-v-e3b08faf>导出特定数据结构</strong> 的 <code data-v-e3b08faf>Common JS 模块</code>。如果你开发过前端项目，并且配置过 <code data-v-e3b08faf>webpack.config.js</code>，你可能会对开发插件的方式感到熟悉。</p><p data-v-e3b08faf>插件中的配置可以大体分为两类：一类是用来说明插件信息的 <strong data-v-e3b08faf>属性</strong>（比如插件名、插件的版本号）；另一类是让软件在合适的时机调用的 <strong data-v-e3b08faf>函数</strong>（比如获取音源的函数等）。</p><p data-v-e3b08faf>在软件中的每一项动作 （如获取音源 URL、搜索等），<strong data-v-e3b08faf>都对应着插件中导出的某个函数</strong> （比如 <code data-v-e3b08faf>获取音源</code> 对应着 <code data-v-e3b08faf>getMediaSource</code> 函数，<code data-v-e3b08faf>搜索</code> 对应着 <code data-v-e3b08faf>search</code> 函数）。</p><p data-v-e3b08faf>一个简单的插件结构如下：</p><div class="language-javascript vp-adaptive-theme" data-v-e3b08faf><button title="Copy Code" class="copy" data-v-e3b08faf></button><span class="lang" data-v-e3b08faf>javascript</span><pre class="shiki github-dark vp-code-dark" data-v-e3b08faf><code data-v-e3b08faf><span class="line" data-v-e3b08faf><span style="color:#79B8FF;" data-v-e3b08faf>module</span><span style="color:#E1E4E8;" data-v-e3b08faf>.</span><span style="color:#79B8FF;" data-v-e3b08faf>exports</span><span style="color:#E1E4E8;" data-v-e3b08faf> </span><span style="color:#F97583;" data-v-e3b08faf>=</span><span style="color:#E1E4E8;" data-v-e3b08faf> {</span></span>
<span class="line" data-v-e3b08faf><span style="color:#E1E4E8;" data-v-e3b08faf>  </span><span style="color:#6A737D;" data-v-e3b08faf>/** 用来说明插件信息的属性 */</span></span>
<span class="line" data-v-e3b08faf><span style="color:#E1E4E8;" data-v-e3b08faf>  platform: </span><span style="color:#9ECBFF;" data-v-e3b08faf>&quot;MusicFree 插件&quot;</span><span style="color:#E1E4E8;" data-v-e3b08faf>, </span><span style="color:#6A737D;" data-v-e3b08faf>// 插件名</span></span>
<span class="line" data-v-e3b08faf><span style="color:#E1E4E8;" data-v-e3b08faf>  version: </span><span style="color:#9ECBFF;" data-v-e3b08faf>&quot;0.0.0&quot;</span><span style="color:#E1E4E8;" data-v-e3b08faf>, </span><span style="color:#6A737D;" data-v-e3b08faf>// 插件版本号</span></span>
<span class="line" data-v-e3b08faf></span>
<span class="line" data-v-e3b08faf><span style="color:#E1E4E8;" data-v-e3b08faf>  </span><span style="color:#6A737D;" data-v-e3b08faf>/** 供给软件在合适的时机调用的函数 */</span></span>
<span class="line" data-v-e3b08faf><span style="color:#E1E4E8;" data-v-e3b08faf>  </span><span style="color:#B392F0;" data-v-e3b08faf>getMediaSource</span><span style="color:#E1E4E8;" data-v-e3b08faf>: </span><span style="color:#F97583;" data-v-e3b08faf>function</span><span style="color:#E1E4E8;" data-v-e3b08faf> (</span><span style="color:#FFAB70;" data-v-e3b08faf>musicItem</span><span style="color:#E1E4E8;" data-v-e3b08faf>) {</span></span>
<span class="line" data-v-e3b08faf><span style="color:#E1E4E8;" data-v-e3b08faf>    </span><span style="color:#6A737D;" data-v-e3b08faf>// 根据该音源的某个音乐获取真实的播放地址</span></span>
<span class="line" data-v-e3b08faf><span style="color:#E1E4E8;" data-v-e3b08faf>    </span><span style="color:#F97583;" data-v-e3b08faf>return</span><span style="color:#E1E4E8;" data-v-e3b08faf> {</span></span>
<span class="line" data-v-e3b08faf><span style="color:#E1E4E8;" data-v-e3b08faf>      url: </span><span style="color:#9ECBFF;" data-v-e3b08faf>&quot;https://&quot;</span><span style="color:#E1E4E8;" data-v-e3b08faf>, </span><span style="color:#6A737D;" data-v-e3b08faf>// 音源 URL</span></span>
<span class="line" data-v-e3b08faf><span style="color:#E1E4E8;" data-v-e3b08faf>    };</span></span>
<span class="line" data-v-e3b08faf><span style="color:#E1E4E8;" data-v-e3b08faf>  },</span></span>
<span class="line" data-v-e3b08faf><span style="color:#E1E4E8;" data-v-e3b08faf>};</span></span></code></pre><pre class="shiki github-light vp-code-light" data-v-e3b08faf><code data-v-e3b08faf><span class="line" data-v-e3b08faf><span style="color:#005CC5;" data-v-e3b08faf>module</span><span style="color:#24292E;" data-v-e3b08faf>.</span><span style="color:#005CC5;" data-v-e3b08faf>exports</span><span style="color:#24292E;" data-v-e3b08faf> </span><span style="color:#D73A49;" data-v-e3b08faf>=</span><span style="color:#24292E;" data-v-e3b08faf> {</span></span>
<span class="line" data-v-e3b08faf><span style="color:#24292E;" data-v-e3b08faf>  </span><span style="color:#6A737D;" data-v-e3b08faf>/** 用来说明插件信息的属性 */</span></span>
<span class="line" data-v-e3b08faf><span style="color:#24292E;" data-v-e3b08faf>  platform: </span><span style="color:#032F62;" data-v-e3b08faf>&quot;MusicFree 插件&quot;</span><span style="color:#24292E;" data-v-e3b08faf>, </span><span style="color:#6A737D;" data-v-e3b08faf>// 插件名</span></span>
<span class="line" data-v-e3b08faf><span style="color:#24292E;" data-v-e3b08faf>  version: </span><span style="color:#032F62;" data-v-e3b08faf>&quot;0.0.0&quot;</span><span style="color:#24292E;" data-v-e3b08faf>, </span><span style="color:#6A737D;" data-v-e3b08faf>// 插件版本号</span></span>
<span class="line" data-v-e3b08faf></span>
<span class="line" data-v-e3b08faf><span style="color:#24292E;" data-v-e3b08faf>  </span><span style="color:#6A737D;" data-v-e3b08faf>/** 供给软件在合适的时机调用的函数 */</span></span>
<span class="line" data-v-e3b08faf><span style="color:#24292E;" data-v-e3b08faf>  </span><span style="color:#6F42C1;" data-v-e3b08faf>getMediaSource</span><span style="color:#24292E;" data-v-e3b08faf>: </span><span style="color:#D73A49;" data-v-e3b08faf>function</span><span style="color:#24292E;" data-v-e3b08faf> (</span><span style="color:#E36209;" data-v-e3b08faf>musicItem</span><span style="color:#24292E;" data-v-e3b08faf>) {</span></span>
<span class="line" data-v-e3b08faf><span style="color:#24292E;" data-v-e3b08faf>    </span><span style="color:#6A737D;" data-v-e3b08faf>// 根据该音源的某个音乐获取真实的播放地址</span></span>
<span class="line" data-v-e3b08faf><span style="color:#24292E;" data-v-e3b08faf>    </span><span style="color:#D73A49;" data-v-e3b08faf>return</span><span style="color:#24292E;" data-v-e3b08faf> {</span></span>
<span class="line" data-v-e3b08faf><span style="color:#24292E;" data-v-e3b08faf>      url: </span><span style="color:#032F62;" data-v-e3b08faf>&quot;https://&quot;</span><span style="color:#24292E;" data-v-e3b08faf>, </span><span style="color:#6A737D;" data-v-e3b08faf>// 音源 URL</span></span>
<span class="line" data-v-e3b08faf><span style="color:#24292E;" data-v-e3b08faf>    };</span></span>
<span class="line" data-v-e3b08faf><span style="color:#24292E;" data-v-e3b08faf>  },</span></span>
<span class="line" data-v-e3b08faf><span style="color:#24292E;" data-v-e3b08faf>};</span></span></code></pre></div><p data-v-e3b08faf>关于插件在代码中的实现细节可以 <a href="https://mp.weixin.qq.com/s/pjyOjTDrV85ImRQ6EWbgAg" target="_blank" rel="noreferrer" data-v-e3b08faf>参考这里</a>。桌面版的实现机制和安卓版略有差异，但基本原理相同。</p><h4 id="插件加载的原理" tabindex="-1" data-v-e3b08faf>插件加载的原理 <a class="header-anchor" href="#插件加载的原理" aria-label="Permalink to &quot;插件加载的原理&quot;" data-v-e3b08faf>​</a></h4><p data-v-e3b08faf>之前说过，MusicFree 的插件其实是满足某种规范的 js 文件，它独立于软件存在，<strong data-v-e3b08faf>软件启动的时候会去特定的文件夹下搜索 js 文件，并加载到程序中。</strong></p><p data-v-e3b08faf>以手机版为例，程序中存储插件的路径是 <code data-v-e3b08faf>Android/data/{包名}/files/plugins</code>。</p><p data-v-e3b08faf>MusicFree 的包名是 <code data-v-e3b08faf>fun.upup.musicfree</code>，所以你可以尝试打开一下手机文件管理的 <code data-v-e3b08faf>Android/data/fun.upup.musicfree/files/plugins</code> 路径，你会发现一系列 <code data-v-e3b08faf>xxx.js</code> 文件。</p><div class="img-container" data-v-e3b08faf><img src="/img/plugin-list.jpg" data-v-e3b08faf></div><p data-v-e3b08faf>如果想要查看具体内容的话，你可以把后缀名改成 <code data-v-e3b08faf>.txt</code>，并打开（记得改回去）。</p><div class="img-container" data-v-e3b08faf><img src="/img/plugin-content.jpg" data-v-e3b08faf></div><p data-v-e3b08faf>可以看到 <code data-v-e3b08faf>module.exports</code> 有一些字段，这些其实都和程序中一一对应，比如 <code data-v-e3b08faf>platform</code> 代表这个插件的名字，<code data-v-e3b08faf>version</code> 代表这个插件的版本号，以及如果有 <code data-v-e3b08faf>srcUrl</code> 字段的话，那么这就是用于插件更新的远程地址。</p><p data-v-e3b08faf>插件的加载逻辑做的比较重，因此对于基于 MusicFree 开发的软件，如果不做大的改动，插件大概率也会以<strong data-v-e3b08faf>本地文件</strong>的形式存储在 <code data-v-e3b08faf>Android/data/{包名}/files/plugins</code> 路径下，并且也可以被 MusicFree 加载。</p><div class="tip custom-block" data-v-e3b08faf><p class="custom-block-title" data-v-e3b08faf>总结</p><p data-v-e3b08faf>已安装的插件实际上是被拷贝到了固定路径，安卓是 <code data-v-e3b08faf>Android/data/fun.upup.musicfree/files/plugins</code>；桌面端是 <code data-v-e3b08faf>C://Users/{userName}/AppData/Roaming/MusicFree/musicfree-plugins</code>。每次启动应用时，都会从对应路径下扫描并加载插件。</p></div><h4 id="插件安装的原理" tabindex="-1" data-v-e3b08faf>插件安装的原理 <a class="header-anchor" href="#插件安装的原理" aria-label="Permalink to &quot;插件安装的原理&quot;" data-v-e3b08faf>​</a></h4><p data-v-e3b08faf>插件安装时，首先会检测当前有没有安装过同名插件。所谓同名，就是指 <code data-v-e3b08faf>platform</code> 字段相同，如果相同就会认为是同一个插件。</p><p data-v-e3b08faf>接下来，会去根据插件的 <code data-v-e3b08faf>version</code> 字段对比版本。如果本地已经存在更新版本 (要安装的版本号小于本地版本号) 的插件，那么插件会安装失败。</p><p data-v-e3b08faf>版本号是类似于 <code data-v-e3b08faf>1.2.3</code> 的形式，比较的时候从后往前比，比如 <code data-v-e3b08faf>1.2.4 &gt; 1.2.3</code>，<code data-v-e3b08faf>2.0.0 &gt; 1.99.99</code>。<strong data-v-e3b08faf>因此，如果要安装旧版本的插件，需要先卸载本地的更新版本的插件，然后再安装旧版。</strong></p><p data-v-e3b08faf>如果以上验证通过，那么接下来就开始安装插件了。安装的过程就是往存储插件的路径里写入一个 <code data-v-e3b08faf>js</code> 文件，为了避免冲突，这个文件的名字会<strong data-v-e3b08faf>随机生成</strong>。</p><h2 id="生命周期" tabindex="-1" data-v-e3b08faf>生命周期 <a class="header-anchor" href="#生命周期" aria-label="Permalink to &quot;生命周期&quot;" data-v-e3b08faf>​</a></h2><p data-v-e3b08faf>插件在被加载或软件启动时，会自动执行插件函数的函数体，并将插件的模块导出（module.exports）作为插件的实例。</p><p data-v-e3b08faf>插件实例和插件中的数据会在软件的生命周期内<strong data-v-e3b08faf>持续存在</strong>，直至软件或者插件被卸载。</p><h2 id="插件的性能" tabindex="-1" data-v-e3b08faf>插件的性能 <a class="header-anchor" href="#插件的性能" aria-label="Permalink to &quot;插件的性能&quot;" data-v-e3b08faf>​</a></h2><p data-v-e3b08faf>插件执行的上下文和软件内（无论是桌面版还是安卓版） Javascript 代码执行的上下文相同，因此性能方面理论上和软件内直接写死源 <strong data-v-e3b08faf>无差别</strong>。</p><div class="danger custom-block" data-v-e3b08faf><p class="custom-block-title" data-v-e3b08faf>DANGER</p><p data-v-e3b08faf>也正因如此，插件内有可能会有些破坏软件本体执行的逻辑，因此插件的使用者需要谨慎识别插件的来源。</p></div><details class="details custom-block" data-v-e3b08faf><summary data-v-e3b08faf>为什么要这样设计？</summary><p data-v-e3b08faf>尽管在安全性上有弱点，但是这样做没有额外的序列化和反序列化步骤，性能会好一点点；同时设计之初以技术探索为主，没有太多安全性上的考虑。</p><p data-v-e3b08faf>再者，插件是用 javascript 编写，简单看一下插件内容也能大概判断插件的安全性，因此暂时保持这样的设计，后续如果有需求再逐渐完善。</p></details><h2 id="如何开发插件" tabindex="-1" data-v-e3b08faf>如何开发插件 <a class="header-anchor" href="#如何开发插件" aria-label="Permalink to &quot;如何开发插件&quot;" data-v-e3b08faf>​</a></h2><p data-v-e3b08faf>对于开发方式没有限制，你只需要保证最终生成一个 <code data-v-e3b08faf>导出 MusicFree 协议</code> 的 <code data-v-e3b08faf>Common.js</code> 模块即可。</p><p data-v-e3b08faf>方便起见，你可以按照 <a href="https://github.com/maotoumao/MusicFreePluginTemplate" target="_blank" rel="noreferrer" data-v-e3b08faf>此模板</a> 完善插件。开发完成后，执行：</p><div class="language-bash vp-adaptive-theme" data-v-e3b08faf><button title="Copy Code" class="copy" data-v-e3b08faf></button><span class="lang" data-v-e3b08faf>bash</span><pre class="shiki github-dark vp-code-dark" data-v-e3b08faf><code data-v-e3b08faf><span class="line" data-v-e3b08faf><span style="color:#B392F0;" data-v-e3b08faf>npm</span><span style="color:#E1E4E8;" data-v-e3b08faf> </span><span style="color:#9ECBFF;" data-v-e3b08faf>run</span><span style="color:#E1E4E8;" data-v-e3b08faf> </span><span style="color:#9ECBFF;" data-v-e3b08faf>build</span></span></code></pre><pre class="shiki github-light vp-code-light" data-v-e3b08faf><code data-v-e3b08faf><span class="line" data-v-e3b08faf><span style="color:#6F42C1;" data-v-e3b08faf>npm</span><span style="color:#24292E;" data-v-e3b08faf> </span><span style="color:#032F62;" data-v-e3b08faf>run</span><span style="color:#24292E;" data-v-e3b08faf> </span><span style="color:#032F62;" data-v-e3b08faf>build</span></span></code></pre></div><p data-v-e3b08faf>安装 <code data-v-e3b08faf>dist/plugin.js</code> 即可。</p><p data-v-e3b08faf>除了使用模板外，你也可以基于 <a href="https://github.com/maotoumao/MusicFreePlugins" target="_blank" rel="noreferrer" data-v-e3b08faf>示例插件</a> 修改。示例插件仓库最终的可安装文件在 <code data-v-e3b08faf>dist</code> 文件夹下。</p><h2 id="如何调试插件" tabindex="-1" data-v-e3b08faf>如何调试插件 <a class="header-anchor" href="#如何调试插件" aria-label="Permalink to &quot;如何调试插件&quot;" data-v-e3b08faf>​</a></h2><p data-v-e3b08faf>前面说过，插件本质上是一个导出特定数据结构的 <code data-v-e3b08faf>Common JS 模块</code>。如果需要调试插件，你只需要在 node.js 环境下调用对应的函数，判断函数的返回值是否符合预期即可。</p><div class="warning custom-block" data-v-e3b08faf><p class="custom-block-title" data-v-e3b08faf>WARNING</p><p data-v-e3b08faf>如果使用到 <code data-v-e3b08faf>@react-native-cookies/cookies</code>，无法直接在 node.js 环境下调试，因为这个包有一些原生依赖。如果需要调试，需要启动 MusicFree 项目，并在软件内调试。</p></div><div class="danger custom-block" data-v-e3b08faf><p class="custom-block-title" data-v-e3b08faf>DANGER</p><p data-v-e3b08faf>同样需要注意，插件内可以引入第三方库 (比如你想在插件中使用 lodash 等)，但插件内只能引入 <span style="color:var(--vp-c-danger-1);" data-v-e3b08faf>纯 Javascript 库</span>，如果第三方库存在一些原生依赖，则无法使用。</p></div><hr data-v-e3b08faf><p data-v-e3b08faf>接下来，你可以简单阅读一下 <a href="/plugin/basic-type.html" data-v-e3b08faf>基本媒体类型</a> 一节，大概了解一下插件内部的一些通用的数据结构，然后就可以根据插件协议开发了。</p></div></div></main><footer class="VPDocFooter" data-v-6b87e69f data-v-ef5dee53><!--[--><!--]--><div class="edit-info" data-v-ef5dee53><div class="edit-link" data-v-ef5dee53><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/maotoumao/musicfree.upup.fun/edit/master/docs/plugin/introduction.md" target="_blank" rel="noreferrer" data-v-ef5dee53><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="edit-link-icon" aria-label="edit icon" data-v-ef5dee53><path d="M18,23H4c-1.7,0-3-1.3-3-3V6c0-1.7,1.3-3,3-3h7c0.6,0,1,0.4,1,1s-0.4,1-1,1H4C3.4,5,3,5.4,3,6v14c0,0.6,0.4,1,1,1h14c0.6,0,1-0.4,1-1v-7c0-0.6,0.4-1,1-1s1,0.4,1,1v7C21,21.7,19.7,23,18,23z"></path><path d="M8,17c-0.3,0-0.5-0.1-0.7-0.3C7,16.5,6.9,16.1,7,15.8l1-4c0-0.2,0.1-0.3,0.3-0.5l9.5-9.5c1.2-1.2,3.2-1.2,4.4,0c1.2,1.2,1.2,3.2,0,4.4l-9.5,9.5c-0.1,0.1-0.3,0.2-0.5,0.3l-4,1C8.2,17,8.1,17,8,17zM9.9,12.5l-0.5,2.1l2.1-0.5l9.3-9.3c0.4-0.4,0.4-1.1,0-1.6c-0.4-0.4-1.2-0.4-1.6,0l0,0L9.9,12.5z M18.5,2.5L18.5,2.5L18.5,2.5z"></path></svg> Edit this page<!--]--></a></div><div class="last-updated" data-v-ef5dee53><p class="VPLastUpdated" data-v-ef5dee53 data-v-7e05ebdb>最近更新: <time datetime="2023-11-26T01:45:43.000Z" data-v-7e05ebdb></time></p></div></div><nav class="prev-next" data-v-ef5dee53><div class="pager" data-v-ef5dee53><!----></div><div class="pager" data-v-ef5dee53><a class="pager-link next" href="/plugin/basic-type.html" data-v-ef5dee53><span class="desc" data-v-ef5dee53>Next page</span><span class="title" data-v-ef5dee53>基本媒体类型</span></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-5a346dfe data-v-e03eb2e1><div class="container" data-v-e03eb2e1><p class="message" data-v-e03eb2e1>代码基于 GPL 协议开源，仅供学习参考使用。</p><p class="copyright" data-v-e03eb2e1>Copyright © 2022-present @<a href='https://github.com/maotoumao'>猫头猫</a></p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"qa_index.md\":\"623a5aca\",\"plugin_index.md\":\"9bee94ad\",\"qa_mobile.md\":\"1f955eca\",\"index.md\":\"00929275\",\"qa_common.md\":\"27c8901b\",\"qa_pc.md\":\"04c5915a\",\"usage_pc_install-theme.md\":\"b467f41a\",\"plugin_introduction.md\":\"f4570448\",\"plugin_basic-type.md\":\"922adf75\",\"usage_problems.md\":\"e4a1ab85\",\"usage_index.md\":\"e0536f4f\",\"plugin_how-to-develop.md\":\"bc144af3\",\"usage_mobile_install-plugin.md\":\"96aa59f6\",\"plugin_caution.md\":\"f8d8d99c\",\"plugin_internal-pkgs.md\":\"5a736667\",\"usage_pc_install-plugin.md\":\"a23e6339\",\"usage_mobile_install.md\":\"45be374b\",\"usage_pc_install.md\":\"5eabaa7a\",\"plugin_protocol.md\":\"1229e734\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-cn\",\"dir\":\"ltr\",\"title\":\"MusicFree\",\"description\":\"MusicFree —— 一个插件化、定制化、无广告的音乐播放器。\",\"base\":\"/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"使用指南\",\"link\":\"/usage/mobile/install\"},{\"text\":\"插件开发\",\"link\":\"/plugin/introduction\"},{\"text\":\"常见问题\",\"link\":\"/qa/common\"},{\"text\":\"更新日志\",\"items\":[{\"text\":\"安卓版\",\"link\":\"https://github.com/maotoumao/MusicFree/blob/master/changelog.md\"},{\"text\":\"桌面版\",\"link\":\"https://github.com/maotoumao/MusicFreeDesktop/blob/master/changelog.md\"}]},{\"text\":\"😈我要进群\",\"items\":[{\"text\":\"微信公众号\",\"link\":\"/img/wechat_channel.jpg\"},{\"text\":\"QQ频道\",\"link\":\"https://pd.qq.com/s/e7od7dpgu\"}]},{\"text\":\"💫国内镜像\",\"link\":\"https://musicfree.gitee.io\"}],\"logo\":\"/img/logo.png\",\"sidebar\":{\"/usage/\":[{\"collapsed\":false,\"text\":\"安卓版\",\"base\":\"/usage/\",\"items\":[{\"text\":\"如何安装应用\",\"link\":\"mobile/install\"},{\"text\":\"如何安装插件\",\"link\":\"mobile/install-plugin\"}]},{\"collapsed\":false,\"text\":\"桌面版\",\"base\":\"/usage/\",\"items\":[{\"text\":\"如何安装应用\",\"link\":\"pc/install\"},{\"text\":\"如何安装插件\",\"link\":\"pc/install-plugin\"},{\"text\":\"如何安装主题包\",\"link\":\"pc/install-theme\"}]},{\"text\":\"❓遇到问题了\",\"link\":\"/usage/problems\"}],\"/plugin/\":[{\"text\":\"插件机制简介\",\"link\":\"/plugin/introduction\"},{\"text\":\"基本媒体类型\",\"link\":\"/plugin/basic-type\"},{\"text\":\"插件协议\",\"link\":\"/plugin/protocol\"},{\"text\":\"举个栗子\",\"link\":\"/plugin/how-to-develop\"},{\"text\":\"内置的 npm 包\",\"link\":\"/plugin/internal-pkgs\"},{\"text\":\"注意事项\",\"link\":\"/plugin/caution\"}],\"/qa/\":[{\"text\":\"常见问题 - 共有问题\",\"link\":\"/qa/common\"},{\"text\":\"常见问题 - PC 版\",\"link\":\"/qa/pc\"},{\"text\":\"常见问题 - 安卓版\",\"link\":\"/qa/mobile\"}]},\"footer\":{\"copyright\":\"Copyright © 2022-present @<a href='https://github.com/maotoumao'>猫头猫</a>\",\"message\":\"代码基于 GPL 协议开源，仅供学习参考使用。\"},\"returnToTopLabel\":\"返回顶部\",\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/maotoumao\"},{\"icon\":{\"svg\":\"<svg role=\\\"img\\\" viewBox=\\\"0 0 24 24\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><title>Bilibili</title><path d=\\\"M17.813 4.653h.854c1.51.054 2.769.578 3.773 1.574 1.004.995 1.524 2.249 1.56 3.76v7.36c-.036 1.51-.556 2.769-1.56 3.773s-2.262 1.524-3.773 1.56H5.333c-1.51-.036-2.769-.556-3.773-1.56S.036 18.858 0 17.347v-7.36c.036-1.511.556-2.765 1.56-3.76 1.004-.996 2.262-1.52 3.773-1.574h.774l-1.174-1.12a1.234 1.234 0 0 1-.373-.906c0-.356.124-.658.373-.907l.027-.027c.267-.249.573-.373.92-.373.347 0 .653.124.92.373L9.653 4.44c.071.071.134.142.187.213h4.267a.836.836 0 0 1 .16-.213l2.853-2.747c.267-.249.573-.373.92-.373.347 0 .662.151.929.4.267.249.391.551.391.907 0 .355-.124.657-.373.906zM5.333 7.24c-.746.018-1.373.276-1.88.773-.506.498-.769 1.13-.786 1.894v7.52c.017.764.28 1.395.786 1.893.507.498 1.134.756 1.88.773h13.334c.746-.017 1.373-.275 1.88-.773.506-.498.769-1.129.786-1.893v-7.52c-.017-.765-.28-1.396-.786-1.894-.507-.497-1.134-.755-1.88-.773zM8 11.107c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c0-.373.129-.689.386-.947.258-.257.574-.386.947-.386zm8 0c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c.017-.391.15-.711.4-.96.249-.249.56-.373.933-.373Z\\\"/></svg>\"},\"link\":\"https://space.bilibili.com/12866223\"}],\"lastUpdated\":{\"formatOptions\":{\"dateStyle\":\"short\"},\"text\":\"最近更新\"},\"editLink\":{\"pattern\":\"https://github.com/maotoumao/musicfree.upup.fun/edit/master/docs/:path\"},\"search\":{\"provider\":\"algolia\",\"options\":{\"appId\":\"W5IICABEJY\",\"apiKey\":\"8db476f936633af2908717789658045a\",\"insights\":true,\"indexName\":\"musicfree-upup\",\"placeholder\":\"输入要搜索的内容...\"}}},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}");</script>
    
  </body>
</html>